CREATE TABLE HOUSE_PHOTOS_PATH
(
    HOUSE_ID NUMBER NOT NULL,
    PATH VARCHAR2(255) NOT NULL UNIQUE,
    CONSTRAINT HOUSE_PHOTOS_PATH_FK FOREIGN KEY (HOUSE_ID) REFERENCES HOUSES(HOUSE_ID)
);

CREATE TABLE ROOM_PHOTOS_PATH
(
    HOUSE_ID NUMBER NOT NULL,
    ROOM_NO NUMBER NOT NULL,
    PATH VARCHAR2(255) NOT NULL UNIQUE,
    CONSTRAINT ROOM_PHOTOS_PATH_FK FOREIGN KEY(HOUSE_ID, ROOM_NO) REFERENCES ROOMS(HOUSE_ID, ROOM_NO)
);

DECLARE
BEGIN
    FOR R IN (SELECT HOUSE_ID, PHOTOS_PATH FROM HOUSES)
    LOOP
        INSERT INTO HOUSE_PHOTOS_PATH VALUES (R.HOUSE_ID, R.PHOTOS_PATH);
    END LOOP ;
    COMMIT ;
end;

ALTER TABLE HOUSES
DROP COLUMN PHOTOS_PATH;

ALTER TABLE ROOMS
DROP COLUMN PHOTOS_PATH;

ALTER TABLE HOUSES
ADD MIN_PRICE NUMBER;

ALTER TABLE HOUSES
ADD MAX_PRICE NUMBER;